window.quizQuestions = [
    {
        question: "Hola, Julio. ¿Cómo _____ esta mañana?",
        options: [
            "te sentirías",
            "te encuentras",
            "saldrían",
            "contaría"
        ],
        correct: 1
    },
    {
        question: "¿Qué _______ para la cena de mañana?",
        options: [
            "cociné",
            "cocinaba",
            "cocinaré",
            "había cocinado"
        ],
        correct: 2
    },
    {
        question: "Los estudiantes siempre quieren ir _______",
        options: [
            "en el árbol.",
            "sin alegría.",
            "al parque.",
            "con el cansancio."
        ],
        correct: 2
    },
    {
        question: "¿Qué función cumple 'con cariño' en 'Escribió la carta con cariño'?",
        options: [
            "Sujeto",
            "Complemento directo",
            "Complemento circunstancial",
            "Predicado"
        ],
        correct: 2
    },
    {
        question: "¿Cuál es el modo verbal en 'Ojalá llueva mañana'?",
        options: [
            "Indicativo",
            "Subjuntivo",
            "Imperativo",
            "Condicional"
        ],
        correct: 1
    },
    {
        question: "Observa la imagen de la niña bailando. ¿Qué oración describe mejor la escena?",
        image: "img/quiz/dance.png",
        options: [
            "La niña está saltando en la sala",
            "La niña está practicando sus pasos de baile en la sala",
            "La niña está haciendo ejercicio",
            "La niña está jugando en la sala"
        ],
        correct: 1,
        category: "descripción_acciones"
    },
    {
        question: "La chica con la cámara está sonriendo. ¿Qué expresión usarías para describir su estado de ánimo?",
        image: "img/quiz/camera.jpg",
        options: [
            "Está que no cabe en sí de gozo",
            "Está como pez en el agua",
            "Está que se sube por las paredes",
            "Está que echa chispas"
        ],
        correct: 0,
        category: "expresiones_idiomáticas"
    },
    {
        question: "En el aeropuerto, ¿qué situación refleja la imagen?",
        image: "img/quiz/airport.png",
        options: [
            "El pasajero está haciendo el check-in",
            "La azafata está dando indicaciones sobre la puerta de embarque",
            "El hombre está comprando un billete",
            "Están revisando la documentación"
        ],
        correct: 1,
        category: "situaciones_cotidianas"
    },
    {
        question: "En el pueblo andino, los turistas probablemente están...",
        image: "img/quiz/tourists.png",
        options: [
            "Preguntando por direcciones al centro",
            "Regateando el precio de las artesanías",
            "Pidiendo recomendaciones de restaurantes",
            "Consultando sobre el clima local"
        ],
        correct: 1,
        category: "interacción_cultural"
    },
    {
        question: "En el tren, ¿qué detalle NO corresponde con la imagen?",
        image: "img/quiz/train.png",
        options: [
            "Hay tres pasajeros en el vagón",
            "Dos personas están despiertas",
            "Uno de los pasajeros tiene un brazo enyesado",
            "Un pasajero está leyendo"
        ],
        correct: 1,
        category: "comprensión_detalles"
    },
    {
        question: "Sobre la imagen del gato, elige la descripción que utiliza correctamente los marcadores espaciales:",
        image: "img/quiz/cat.png",
        options: [
            "El gato está acostado sobre la alfombra, entre la cama y el escritorio, mientras las lámparas iluminan el cuarto",
            "El gato está en la alfombra, la cama está al lado del escritorio y hay lámparas",
            "En el cuarto hay un gato, también hay una cama y un escritorio con lámparas",
            "Las lámparas iluminan al gato que está en la alfombra cerca de la cama y el escritorio"
        ],
        correct: 0,
        category: "uso_preposiciones"
    },
    {
        question: "Selecciona la forma verbal correcta: 'Si yo _______ más tiempo, estudiaría otro idioma.'",
        options: [
            "tendría",
            "tuviera",
            "tenía",
            "tenga"
        ],
        correct: 1,
        category: "subjuntivo_condicional"
    },
    {
        question: "Elige la preposición correcta: 'María se dedica _____ enseñar español _____ extranjeros _____ hace cinco años.'",
        options: [
            "a / a / desde",
            "en / para / hace",
            "de / a / desde",
            "por / para / desde"
        ],
        correct: 0,
        category: "uso_preposiciones"
    },
    {
        question: "¿Qué tiempo verbal es correcto? 'Cuando _______ a casa, me llamó mi hermana.'",
        options: [
            "llegué",
            "he llegado",
            "llegaba",
            "había llegado"
        ],
        correct: 0,
        category: "tiempos_pasado"
    },
    {
        question: "Selecciona el adverbio adecuado: 'El tren llegó _______ a la estación porque hubo un problema técnico.'",
        options: [
            "tarde",
            "tardes",
            "tardemente",
            "tardío"
        ],
        correct: 0,
        category: "uso_adverbios"
    },
    {
        question: "Completa con el verbo en subjuntivo: 'Es necesario que _______ (tú) el formulario antes de viajar.'",
        options: [
            "rellenas",
            "rellenarás",
            "rellenes",
            "rellenaste"
        ],
        correct: 2,
        category: "subjuntivo_presente"
    },
    {
        question: "Elige la expresión temporal correcta: '_______ que empecé a aprender español, he hecho muchos amigos.'",
        options: [
            "Desde",
            "Hace",
            "Durante",
            "Mientras"
        ],
        correct: 0,
        category: "expresiones_temporales"
    },
    {
        question: "Lee el siguiente diálogo y elige la opción que completa la conversación:\n- ¿Te importaría prestarme tus apuntes?\n- _______",
        options: [
            "No, para nada. Te los traigo mañana",
            "Sí, me importa mucho",
            "No me importa nada",
            "Sí, tráelos mañana"
        ],
        correct: 0,
        category: "cortesía_pragmática"
    },
    {
        question: "¿Qué pronombre relativo completa correctamente la frase? 'La ciudad _____ vivo tiene un clima muy agradable.'",
        options: [
            "que",
            "donde",
            "cual",
            "quien"
        ],
        correct: 1,
        category: "pronombres_relativos"
    },
    {
        question: "Identifica el conector adecuado: 'No pude llegar temprano _______ había mucho tráfico.'",
        options: [
            "porque",
            "pero",
            "sino",
            "aunque"
        ],
        correct: 0,
        category: "conectores_discursivos"
    },
    {
        question: "Selecciona la perífrasis verbal correcta: 'Mi hermana _______ estudiar medicina el próximo año.'",
        options: [
            "va a",
            "está a",
            "viene de",
            "sigue de"
        ],
        correct: 0,
        category: "perífrasis_verbales"
    },
    {
        question: "¿Qué opción expresa mejor probabilidad en presente? 'Son las 10 y Juan no ha llegado, _______.'",
        options: [
            "estará enfermo",
            "está enfermo",
            "estuvo enfermo",
            "ha estado enfermo"
        ],
        correct: 0,
        category: "expresión_probabilidad"
    },
    {
        question: "Completa con el modo correcto: 'Te sugiero que _______ (ir) al médico.'",
        options: [
            "vas",
            "vayas",
            "irás",
            "fuiste"
        ],
        correct: 1,
        category: "subjuntivo_sugerencia"
    },
    {
        question: "Escucha el audio y selecciona la opción que mejor describe la situación:",
        audio: "audio/quiz/beisbol-cuba.mp3",
        audioText: "Transcripción del audio (oculta hasta completar el ejercicio)",
        options: [
            "Una reserva en un restaurante",
            "Una cita médica",
            "Una compra de entradas",
            "Una consulta de horarios"
        ],
        correct: 0,
        category: "comprensión_auditiva"
    },
    {
        question: "¿Qué emoción expresa principalmente la persona que habla?",
        audio: "audio/quiz/beisbol-cuba.mp3",
        audioText: "Transcripción del audio (oculta)",
        options: [
            "Entusiasmo",
            "Preocupación",
            "Indiferencia",
            "Sorpresa"
        ],
        correct: 1,
        category: "comprensión_emocional"
    },
    {
        question: "Escucha el audio y responde: ¿Dónde se celebran los carnavales más espectaculares según el hablante?",
        audio: "audio/quiz/carnaval_espana.mp3",
        audioText: "En España se celebra mucho el carnaval, hay muchos carnavales y, bueno, los más espectaculares con diferencias son los de Tenerife y Gran Canaria, hay mucha fiesta en la calle, hace mucho calor, se preparan mucho los desfiles, los trajes.",
        options: [
            "Madrid y Barcelona",
            "Tenerife y Gran Canaria",
            "Sevilla y Valencia",
            "Cádiz y Málaga"
        ],
        correct: 1,
        category: "comprensión_auditiva"
    },
    {
        question: "Según el audio, ¿qué caracteriza a estos carnavales?",
        audio: "audio/quiz/carnaval_espana.mp3",
        audioText: "En España se celebra mucho el carnaval, hay muchos carnavales y, bueno, los más espectaculares con diferencias son los de Tenerife y Gran Canaria, hay mucha fiesta en la calle, hace mucho calor, se preparan mucho los desfiles, los trajes.",
        options: [
            "Son muy tranquilos y familiares",
            "Tienen mucha fiesta en la calle y elaborados desfiles",
            "Son principalmente religiosos",
            "Se celebran en invierno con mucho frío"
        ],
        correct: 1,
        category: "inferencia_contextual"
    },
    {
        question: "¿Qué palabra se repite más en el audio?",
        audio: "audio/quiz/carnaval_espana.mp3",
        audioText: "En España se celebra mucho el carnaval, hay muchos carnavales y, bueno, los más espectaculares con diferencias son los de Tenerife y Gran Canaria, hay mucha fiesta en la calle, hace mucho calor, se preparan mucho los desfiles, los trajes.",
        options: [
            "España",
            "Carnaval",
            "Mucho",
            "Fiesta"
        ],
        correct: 2,
        category: "atención_detalle"
    },
    {
        question: "Escucha el audio y responde: ¿Dónde se encuentra el glaciar Perito Moreno?",
        audio: "audio/quiz/argentina_glaciar.mp3",
        audioText: "En el sur de Argentina hace mucho frío por su proximidad con la con la Antártida, allí se encuentra el glaciar perito moreno, que es una gran extensión de hielo, atrae mucho turismo y es uno de los espectáculos naturales más grandes que hay en este planeta.",
        options: [
            "En el norte de Argentina",
            "En el sur de Argentina",
            "En la Antártida",
            "En Chile"
        ],
        correct: 1,
        category: "comprensión_auditiva"
    },
    {
        question: "Según el audio, ¿por qué hace mucho frío en el sur de Argentina?",
        audio: "audio/quiz/argentina_glaciar.mp3",
        audioText: "En el sur de Argentina hace mucho frío por su proximidad con la con la Antártida, allí se encuentra el glaciar perito moreno, que es una gran extensión de hielo, atrae mucho turismo y es uno de los espectáculos naturales más grandes que hay en este planeta.",
        options: [
            "Por la altitud de las montañas",
            "Por su proximidad con la Antártida",
            "Por las corrientes marinas",
            "Por el cambio climático"
        ],
        correct: 1,
        category: "relación_causa_efecto"
    },
    {
        question: "¿Qué error gramatical se comete en el audio?",
        audio: "audio/quiz/argentina_glaciar.mp3",
        audioText: "En el sur de Argentina hace mucho frío por su proximidad con la con la Antártida, allí se encuentra el glaciar perito moreno, que es una gran extensión de hielo, atrae mucho turismo y es uno de los espectáculos naturales más grandes que hay en este planeta.",
        options: [
            "Repetición de 'con la'",
            "Falta de artículo antes de 'Argentina'",
            "Uso incorrecto de 'allí'",
            "Falta de mayúscula en 'perito moreno'"
        ],
        correct: 0,
        category: "análisis_gramatical"
    }
]; 

// Función única para verificar y corregir rutas de recursos (imágenes/audio)
function verifyAndFixResources() {
    if (!window.quizQuestions) return;
    
    console.log("🔄 Verificando recursos de preguntas...");
    
    window.quizQuestions.forEach((question, index) => {
        // Procesar imágenes
        if (question.image) {
            // Normalizar ruta de imagen
            if (!question.image.startsWith('img/quiz/')) {
                const fileName = question.image.split('/').pop();
                question.image = `img/quiz/${fileName}`;
                console.log(`🖼️ Corrigiendo ruta de imagen en pregunta ${index+1}: ${question.image}`);
            }
            
            // Verificar si la imagen existe
            const img = new Image();
            img.onerror = () => {
                console.warn(`⚠️ Imagen no encontrada: ${question.image}, usando respaldo`);
                question.originalImage = question.image; // Guardar la original por si acaso
                question.image = 'img/quiz/placeholder.jpg';
            };
            img.src = question.image;
        }
        
        // Procesar audio
        if (question.audio) {
            // Normalizar ruta de audio
            if (!question.audio.startsWith('audio/quiz/')) {
                const fileName = question.audio.split('/').pop();
                question.audio = `audio/quiz/${fileName}`;
                console.log(`🔊 Corrigiendo ruta de audio en pregunta ${index+1}: ${question.audio}`);
            }
            
            // No podemos verificar fácilmente si el audio existe como con las imágenes
            // Pero podemos preparar un plan de respaldo para el reproductor
        }
    });
    
    // Modificar el método que muestra imágenes para usar respaldo si falla
    if (window.Quiz && window.Quiz.prototype) {
    window.Quiz.prototype.createImageContainer = function(question) {
        if (!question.image) return '';
        
        return `
            <div class="image-container mb-4 text-center">
                <img src="${question.image}" 
                     alt="Imagen para pregunta ${this.currentQuestion + 1}"
                     class="img-fluid rounded"
                     style="max-height: 300px;"
                     onerror="this.onerror=null; this.src='img/quiz/placeholder.jpg'; 
                             this.parentNode.innerHTML += '<p class=\\'text-danger mt-2\\'>Imagen no disponible</p>';">
            </div>
        `;
    };
    
        // También modificar el método que maneja los audios para incluir respaldo
        const originalCreateAudioElement = window.Quiz.prototype.createAudioElement;
        window.Quiz.prototype.createAudioElement = function(question) {
            if (!question.audio) return '';
            
            return `
                <div class="audio-container mb-4">
                    <audio controls class="w-100" onError="this.outerHTML='<div class=\\'alert alert-warning\\'>Audio no disponible</div>'">
                        <source src="${question.audio}" type="audio/mpeg">
                        Tu navegador no soporta el elemento de audio.
                    </audio>
                </div>
            `;
        };
    }
    
    console.log("✅ Verificación de recursos completada");
}

// Ejecutar una sola vez cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(verifyAndFixResources, 500); // Un pequeño retraso para asegurar que todo está cargado
}); 